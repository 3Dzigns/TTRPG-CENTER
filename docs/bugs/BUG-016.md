# BUG-023: Artifact schema: ensure 'chunks' key exists (even if empty) and atomic writes


## Summary
Validators fail because `split_index.json`/`manifest.json` sometimes lack the required `"chunks"` key.

## Impact
Pass B/C validations fail, aborting ingestion.

## Fix
- Ensure writers always emit a top-level `"chunks": []` (empty allowed) before finalizing file.
- Use atomic write: write to temp, fsync, rename to final.

## Acceptance Criteria (User Stories)
**US-023A (Dev)**: As a developer, even empty extractions still produce files with `"chunks": []`.
**US-023B (QA)**: As QA, schema validator never fails for missing `"chunks"` on valid runs.

## Test Cases
**Unit**
- Writer receives 0 chunks → output JSON has `chunks: []` and passes schema.
- Validator rejects files without `chunks` (guard retained).

**Functional**
- Run a doc that yields no parseable text → pipeline proceeds with empty chunks instead of error.
