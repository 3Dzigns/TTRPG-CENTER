# BUG-021: Normalize vector dimension to 1024 and add preflight


## Summary
Standardize vector **dimension = 1024** across the pipeline to match AstraDB collection indexes. Prevent silent mismatches between the embedder output and collection schema.

## Impact
Potential retrieval failures or latent index corruption if mismatched dims are inserted (usually produces hard errors; this fix enforces consistency).

## Fix
- Configure embedder to produce 1024-d vectors (e.g., choose a 1024-d model or project to 1024).
- Verify all vector collections are created with `dimension=1024`.
- Add a preflight that compares `embedder_dim` vs `collection.dimension` before first insert.

## Acceptance Criteria (User Stories)
**US-021A (Dev)**: As a developer, running preflight prints `Vectors: 1024 (model) == 1024 (collection)`.
**US-021B (Ops)**: As an operator, attempts to run with mismatched dims fail fast with a clear error and remediation hint.

## Test Cases
**Unit**
- Mock `get_model_dim()` = 1000 vs collection=1024 → preflight raises SystemExit with explicit message.
- Matching case passes.

**Functional**
- Insert 5 vectors (1024) → collection accepts and query returns topK without error.

**Regression**
- Changing model config requires bumping a version file; CI blocks if preflight fails.
